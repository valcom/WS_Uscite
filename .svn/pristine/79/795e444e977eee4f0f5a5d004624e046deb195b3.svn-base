/**
 * 
 */
package it.ccse.uscite.application.facade.impl;

import java.util.List;

import javax.jws.WebService;
import javax.transaction.Transactional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.domain.Page;

import it.ccse.uscite.application.facade.UsciteWSFacade;
import it.ccse.uscite.application.facade.assembler.Assembler;
import it.ccse.uscite.application.facade.dto.input.AggiornaFideiussione_InDTO;
import it.ccse.uscite.application.facade.dto.input.AggiornaSemaforiAnagrafica_InDTO;
import it.ccse.uscite.application.facade.dto.input.SearchPratiche_InDTO;
import it.ccse.uscite.application.facade.dto.output.AggiornaFideiussione_OutDTO;
import it.ccse.uscite.application.facade.dto.output.AggiornaSemaforiAnagrafica_OutDTO;
import it.ccse.uscite.application.facade.dto.output.SearchPratiche_OutDTO;
import it.ccse.uscite.application.service.PraticaErogazioneService;
import it.ccse.uscite.domain.PraticaErogazione;
import it.ccse.uscite.domain.SettoreAttivita;
import it.ccse.uscite.domain.common.PageableRequest;
import it.ccse.uscite.domain.filter.PraticaFilter;

/**
 * @author vcompagnone
 *
 */
@Transactional
@WebService(targetNamespace = "it.ccse.uscite",serviceName = "UsciteWS")
public class UsciteWSFacadeImpl implements UsciteWSFacade {

	@Autowired
	private Assembler assembler;
	
	@Autowired
	private PraticaErogazioneService praticaErogazioneService;
	
	@Override
	public AggiornaSemaforiAnagrafica_OutDTO aggiornaSemaforiAnagrafica(
			AggiornaSemaforiAnagrafica_InDTO aggiornaSemaforiAnagrafica_InDTO) {
		List<SettoreAttivita> settoriAttivita = assembler.toSettoriAttivita(aggiornaSemaforiAnagrafica_InDTO);
		return assembler.toAggiornaSemaforiAnagrafica_OutDTO(praticaErogazioneService.aggiornaSemaforiAnagrafica(settoriAttivita));
	}

	@Override
	public SearchPratiche_OutDTO searchPratiche(
			SearchPratiche_InDTO searchPratiche_InDTO) {
		PageableRequest<PraticaFilter> filter = assembler.toPraticaFilter(searchPratiche_InDTO);
		Page<PraticaErogazione> pratiche = praticaErogazioneService.searchPraticheErogazione(filter);
		return assembler.toSearchPratiche_OutDTO(pratiche);
	}

	@Override
	public AggiornaFideiussione_OutDTO aggiornaFideiussione(
			AggiornaFideiussione_InDTO aggiornaFideiussione_InDTO) {
		
		List<PraticaErogazione> pratiche = assembler.toPratiche(aggiornaFideiussione_InDTO);
		
		pratiche = praticaErogazioneService.aggiornaFideiussione(pratiche);
		
		return assembler.toAggiornaFideiussione_OutDTO(pratiche);
	}
}
